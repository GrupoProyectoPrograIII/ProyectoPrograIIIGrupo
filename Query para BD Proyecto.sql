USE [master]
GO

CREATE DATABASE [DB_PROYECTO_1]
GO

USE [DB_PROYECTO_1]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

IF exists (SELECT * FROM sys.objects WHERE name = 'MODULO' and type = 'u')
	DROP TABLE MODULO
GO

CREATE TABLE MODULO(
	ID_MODULO INT NOT NULL PRIMARY KEY,
	NOMBRE NVARCHAR(80) NOT NULL,
	DESCRIPCION NVARCHAR(MAX) NULL,
	PATH NVARCHAR(MAX) NULL,
	NIVEL INT NULL,
	ORDEN NVARCHAR(30) NULL,
	ID_MODULO_PADRE INT NOT NULL,
	ACTIVO INT NOT NULL
);
GO

INSERT INTO MODULO(ID_MODULO,NOMBRE,DESCRIPCION,PATH,NIVEL,ORDEN,ID_MODULO_PADRE,ACTIVO) 
  VALUES (1,'MANTENIMIENTOS','MODULO DE MANTENIMIENTOS','/MANTENIMIENTOS',1,1,0,1),
  (2,'PROCESOS','MODULO DE PROCESOS','/PROCESOS',1,2,0,1),
  (3,'PEDIDOS','MODULO DE PEDIDOS','/PEDIDOS',1,3,0,1),
  (4,'REPORTES','MODULO DE REPORTES','/REPORTES',1,4,0,1),
  (5,'SEGURIDAD','MODULO DE SEGURIDAD','/SEGURIDAD',1,5,0,1),
  (6,'MODULOS','MODULO DE MODULOS','/MODULOS',2,1,5,1),
  (7,'PERMISOS','MODULO DE PERMISOS','/PERMISOS',2,2,5,1),
  (8,'ROLES','MODULO DE ROLES','/ROLES',2,3,5,1),
  (9,'USUARIOS','MODULO DE USUARIOS','/USUARIOS',2,4,5,1),
  (10,'AREAS','MODULO DE AREAS','/AREAS',2,1,1,1),
  (11,'CLIENTES','MODULO DE CLIENTES','/CLIENTES',2,2,1,1),
  (12,'MESA','MODULO DE MESA','/MESA',2,3,1,1),
  (13,'MONITOR','MODULO DE MONITOR','/MONITOR',2,4,1,1),
  (14,'PRODUCTO COMBINADO','MODULO DE PRODUCTO COMBINADO','/PRODUCTO COMBINADO',2,5,1,1),
  (15,'PRODUCTOS','MODULO DE PRODUCTOS','/PRODUCTOS',2,6,1,1),
  (16,'PROVEEDORES','MODULO DE PROVEEDORES','/PROVEEDORES',2,7,1,1),
  (17,'TIPO PRODUCTO','MODULO DE PRODUCTO','/PRODUCTO',2,8,1,1),
  (18,'DESCARGA INVENTARIO','MODULO DE DESCARGA INVENTARIO','/DESCARGA INVENTARIO',2,1,2,1),
  (19,'FACTURAS AL CREDITO','MODULO DE FACTURAS AL CREDITO','/FACTURAS AL CREDITO',2,2,2,1),
  (20,'PAGO DE PEDIDO','MODULO DE PAGO DE PEDIDO','/PAGO DE PEDIDO',2,3,2,1),
  (21,'CAJA INVENTARIO','MODULO DE CAJA INVENTARIO','/CAJA INVENTARIO',2,4,2,1),
  (22,'CORTE DE CAJA','MODULO DE CORTE DE CAJA','/CORTE DE CAJA',2,5,2,1),
  (23,'SELECCIONAR MESA','MODULO DE SELECCIONAR MESA','/SELECCIONAR MESA',2,1,3,1),
  (24,'ANULAR','MODULO DE ANULAR','/ANULAR',2,2,3,1),
  (25,'ELEJIR MONITOR','MODULO DE ELEJIR MONITOR','/ELEJIR MONITOR',2,3,3,1),
  (26,'INVENTARIO GENERAL','MODULO DE INVENTARIO GENERAL','/INVENTARIO GENERAL',2,1,4,1),
  (27,'INVENTARIO PARCIAL','MODULO DE INVENTARIO PARCIAL','/INVENTARIO PARCIAL',2,2,4,1),
  (28,'CIERRE','MODULO DE CIERRE','/CIERRE',2,3,4,1),
  (29,'MONITOR DE CAJA','MODULO DE MONITOR DE CAJA','/MONITOR DE CAJA',2,4,4,1);
  GO

IF exists (SELECT * FROM sys.objects WHERE name = 'USUARIO' and type = 'u')
	DROP TABLE USUARIO
GO

CREATE TABLE USUARIO(
	ID_USUARIO INT NOT NULL PRIMARY KEY,
	NOMBRE NVARCHAR(50) NOT NULL,
	APELLIDO NVARCHAR(50) NOT NULL,
	USUARIO	NVARCHAR(30) NOT NULL,
	PASSW NVARCHAR(8) NOT NULL, 
	ID_ROL INT NOT NULL,
	ACTIVO INT NOT NULL
);
GO

INSERT INTO USUARIO(ID_USUARIO,NOMBRE,APELLIDO,USUARIO,PASSW,ID_ROL,ACTIVO)
 VALUES (1,'Administrator','System','Admin','12345678',1,1),
 (2,'Edgar','Sandoval','esandoval','123',2,1),
 (3,'Lester','Carrillo','lcarrillo','1234',3,1)
GO

IF exists (SELECT * FROM sys.objects WHERE name = 'ROL' and type = 'u')
	DROP TABLE ROL
GO

CREATE TABLE ROL(
	ID_ROL INT NOT NULL PRIMARY KEY,
	NOMBRE NVARCHAR(50) NOT NULL,
	DESCRIPCION NVARCHAR(MAX) NULL,
	ACTIVO INT NOT NULL
);
GO

INSERT INTO ROL(ID_ROL,NOMBRE,DESCRIPCION,ACTIVO) 
VALUES(1,'Administracion','Rol para administracion del sistema',1),
(2,'Gerencia','Rol para gerentes del sistema',1),
(3,'Empleados','Rol para empleados del sistema',1)
GO

IF exists (SELECT * FROM sys.objects WHERE name = 'PERMISO' and type = 'u')
	DROP TABLE PERMISO
GO

CREATE TABLE PERMISO(
	ID_PERMISO INT NOT NULL PRIMARY KEY,
	ID_MODULO INT NOT NULL,
	ID_ROL INT NOT NULL,
	ACTIVO INT NOT NULL
);
GO

INSERT INTO PERMISO(ID_PERMISO,ID_MODULO,ID_ROL,ACTIVO) 
VALUES(1,1,1,1),
(2,2,1,1),
(3,3,1,1),
(4,4,1,1),
(5,5,1,1),
(6,6,1,1),
(7,7,1,1),
(8,8,1,1),
(9,9,1,1)
GO

SELECT [ID_MODULO]
      ,[NOMBRE]
      ,[DESCRIPCION]
      ,[PATH]
      ,[NIVEL]
      ,[ORDEN]
      ,[ID_MODULO_PADRE]
      ,[ACTIVO]
  FROM [dbo].[MODULO]

GO

SELECT [ID_PERMISO]
      ,[ID_MODULO]
      ,[ID_ROL]
      ,[ACTIVO]
  FROM [dbo].[PERMISO]

GO

SELECT [ID_ROL]
      ,[NOMBRE]
      ,[DESCRIPCION]
      ,[ACTIVO]
  FROM [dbo].[ROL]

  GO

SELECT [ID_USUARIO]
      ,[NOMBRE]
      ,[APELLIDO]
      ,[USUARIO]
      ,[PASSW]
      ,[ID_ROL]
      ,[ACTIVO]
  FROM [dbo].[USUARIO]

GO

